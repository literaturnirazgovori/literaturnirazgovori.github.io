---
layout: default
title: Начало
---

{% if page.url == "/" %}

<!-- Just count...-->
{% assign visibleposts = site.posts  | where:"hidden","false" | size %}
<!-- Total num of visible posts: {{visibleposts}} -->

<!-- Featured ================================================== -->

<!--=========== Banner ===========-->
<a href="/category/mybooks">
<div class="homepage-banner" style="background-image: url('/assets/images/dead-sea-book-banner.png');">
    <div>
        Новата ми книга
    </div>
</div>
</a>
<!--=========== Banner ===========-->

<section class="featured-posts">
    <div class="row">
        {% assign allposts = site.posts %}
        {% for post in allposts reversed %}

        {% if post.featured == true %}

        {% include featuredbox.html %}

        {% endif %}

        {% endfor %}

    </div>
</section>

{% endif %}

<!-- Posts Index
================================================== -->
<section class="recent-posts">
    <div id="postscontainer" class="row listrecent">
    </div>
    <div id="loading">
        <img id="loading-img" src="{{ site.baseurl }}/assets/images/loading.svg" alt="Please wait">
        Зареждане... Моля Изчакайте!
    </div>
    <div id="paginationerror">
        <a id="loadNext" href="javascript:;">Още...</a>
    </div>
</section>

<!-- Pagination
================================================== 
<div class="bottompagination">
    <div class="pointerup"><i class="fa fa-caret-up"></i></div>
    <span class="navigation" role="navigation">
        {% include pagination.html %}
    </span>
</div>
-->
<!-- infinite scroll -->
<script src="{{ site.baseurl }}/assets/js/infinite-scroll.js"></script>
<script>
    var nextpage = "/api/articles.json";
    var paginationError = false;

    function getTheNextPage(pageUrl)
    {
        if(!pageUrl)
            return;
        
        paginationError = false;
        $("#loading").show();
        getpage(pageUrl, function(page){
            if(page)
            {
                for(var i=0; i < page.pages.length; i++)
                {
                    $(htmlDecode(page.pages[i]))
                        .hide()
                        .appendTo("#postscontainer")
                        .fadeIn(800);
                }
                nextpage = page.next;
            }
            $("#loading").hide();
        },
        function(err){
            $("#loading").hide();
            paginationError = true;
            $("#paginationerror").show();
        });
    }

    $(function() {
        getTheNextPage(nextpage);

        var win = $(window);
        // Each time the user scrolls
        win.scroll(function() {
            // End of the document reached?
            if($(window).scrollTop() + $(window).height() > $(document).height() - 200) {
            //if ($(document).height() - win.height() == win.scrollTop()) {
                if(!paginationError){
                    getTheNextPage(nextpage);
                }
            }
        });

        $("#loadNext").click(function(){
            paginationError=false;
            $("#paginationerror").hide();
            getTheNextPage(nextpage);
        });
    });
</script>